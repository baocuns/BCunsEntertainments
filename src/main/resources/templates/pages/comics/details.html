<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head
        th:replace="~{fragments/head :: head(
        title=${comic.getTitle()} + ' | BCuns Entertainment',
        description=${comic.getDescription()},
        keywords=${comic.getTitle()},
        url=${'https://bcent.online/comics/' + comic.getTileSlug()},
        image=${comic.getThumbnails()},
        site_name=${comic.getTitle()}
        )}"
>
    <title>Details</title>
</head>
<body class="scrollbar-hidden bg-white dark:bg-slate-900">
<!-- header -->
<header th:replace="~{fragments/header :: header}"></header>
<!-- Content Comics Details -->
<section class="mt-20">
    <div class="mx-auto mt-6 max-w-4xl px-6 grid grid-cols-1 sm:max-w-7xl sm:grid-cols-4 sm:gap-x-8 sm:px-8">
        <!-- image -->
        <div class="aspect-w-4 aspect-h-5 sm:overflow-hidden sm:aspect-w-3 sm:aspect-h-4 rounded">
            <img
                    th:src="${comic.getThumbnails()}"
                    alt="cover"
                    class="h-96 w-full object-cover object-center rounded"
            />
        </div>
        <div class="col-span-3 dark:text-slate-400">
            <div class="mt-8 sm:mt-2">
                <!-- title -->
                <h1 class="text-2xl font-semibold dark:text-white"
                    id="info-comic"
                    th:data-comic-id="${comic.getId()}"
                    th:text="${comic.getTitle()}"
                    th:data-comic-thumbnail="${comic.getThumbnails()}"
                    th:data-comic-slug="${comic.getTileSlug()}"
                    th:data-comic-count-chapter="${comic.getCountChapter()}"
                    th:data-comic-time-ago="${comic.getUpdateTimeAgo()}"
                >Title</h1>
                <!-- info -->
                <div class="flex font-light mt-4">
                    <div class="mx-2 flex items-center">
                        <i class="fa-light fa-timer"></i>
                    </div>
                    <p th:text="${comic.getUpdateTimeAgo()}">{dayjs(comic.updated_at).fromNow()}</p>
                </div>
                <div class="flex font-light">
                    <div class="mx-2 flex items-center">
                        <i class="fa-light fa-calendar-plus"></i>
                    </div>
                    <p th:text="${comic.getCreateTimeAgo()}">{dayjs(comic.created_at).format('DD/MM/YYYY')}</p>
                </div>
                <div class="flex">
                    <div class="flex font-light mr-4">
                        <div class="mx-2 flex items-center">
                            <i class="fa-light fa-face-hand-peeking"></i>
                        </div>
                        <p th:text="${comic.getView()}">{numberFormat(comic.view, 1)}</p>
                    </div>
                    <div class="flex font-light mr-4">
                        <div class="mx-2 flex items-center">
                            <i class="fa-light fa-face-grin-hearts"></i>
                        </div>
                        <p th:if="${comic.getLikesComics() != null}" th:text="${comic.getLikesComics().size()}">like</p>
                        <p th:unless="${comic.getLikesComics() != null}">0</p>
                    </div>
                    <div class="flex font-light mr-4">
                        <div class="mx-2 flex items-center">
                            <i class="fa-light fa-file-image"></i>
                        </div>
                        <p th:text="${comic.getCountChapter()}">{comic.chapters.length} chapter</p>
                    </div>
                </div>
                <div class="flex font-light">
                    <div class="mx-2 flex items-center">
                        <i class="fa-light fa-comments"></i>
                    </div>
                    <div>
                        <div class="">
                            <h3 class="sr-only">Reviews</h3>
                            <div class="flex items-center">
                                <div class="flex items-center flex-row-reverse cursor-pointer rating"
                                     th:data-is-login="${isLogin}" th:data-is-rating="${isRating}">
                                    <!-- Active: "text-yellow-500", Default: "text-gray-200" thứ tự các ngôi sao bị đảo ngược -->
                                    <svg data-rate="5" class="text-gray-200 rating-star h-5 w-5" viewBox="0 0 20 20"
                                         fill="currentColor" aria-hidden="true">
                                        <path fill-rule="evenodd"
                                              d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.381c-.833.067-1.171 1.107-.536 1.651l3.62 3.102-1.106 4.637c-.194.813.691 1.456 1.405 1.02L10 15.591l4.069 2.485c.713.436 1.598-.207 1.404-1.02l-1.106-4.637 3.62-3.102c.635-.544.297-1.584-.536-1.65l-4.752-.382-1.831-4.401z"
                                              clip-rule="evenodd"/>
                                    </svg>
                                    <svg data-rate="4" class="text-gray-200 rating-star h-5 w-5" viewBox="0 0 20 20"
                                         fill="currentColor" aria-hidden="true">
                                        <path fill-rule="evenodd"
                                              d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.381c-.833.067-1.171 1.107-.536 1.651l3.62 3.102-1.106 4.637c-.194.813.691 1.456 1.405 1.02L10 15.591l4.069 2.485c.713.436 1.598-.207 1.404-1.02l-1.106-4.637 3.62-3.102c.635-.544.297-1.584-.536-1.65l-4.752-.382-1.831-4.401z"
                                              clip-rule="evenodd"/>
                                    </svg>
                                    <svg data-rate="3" class="text-yellow-500 rating-star h-5 w-5" viewBox="0 0 20 20"
                                         fill="currentColor" aria-hidden="true">
                                        <path fill-rule="evenodd"
                                              d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.381c-.833.067-1.171 1.107-.536 1.651l3.62 3.102-1.106 4.637c-.194.813.691 1.456 1.405 1.02L10 15.591l4.069 2.485c.713.436 1.598-.207 1.404-1.02l-1.106-4.637 3.62-3.102c.635-.544.297-1.584-.536-1.65l-4.752-.382-1.831-4.401z"
                                              clip-rule="evenodd"/>
                                    </svg>
                                    <svg data-rate="2" class="text-yellow-500 rating-star h-5 w-5" viewBox="0 0 20 20"
                                         fill="currentColor" aria-hidden="true">
                                        <path fill-rule="evenodd"
                                              d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.381c-.833.067-1.171 1.107-.536 1.651l3.62 3.102-1.106 4.637c-.194.813.691 1.456 1.405 1.02L10 15.591l4.069 2.485c.713.436 1.598-.207 1.404-1.02l-1.106-4.637 3.62-3.102c.635-.544.297-1.584-.536-1.65l-4.752-.382-1.831-4.401z"
                                              clip-rule="evenodd"/>
                                    </svg>
                                    <svg data-rate="1" class="text-yellow-500 rating-star h-5 w-5" viewBox="0 0 20 20"
                                         fill="currentColor" aria-hidden="true">
                                        <path fill-rule="evenodd"
                                              d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.381c-.833.067-1.171 1.107-.536 1.651l3.62 3.102-1.106 4.637c-.194.813.691 1.456 1.405 1.02L10 15.591l4.069 2.485c.713.436 1.598-.207 1.404-1.02l-1.106-4.637 3.62-3.102c.635-.544.297-1.584-.536-1.65l-4.752-.382-1.831-4.401z"
                                              clip-rule="evenodd"/>
                                    </svg>
                                </div>
                                <div class="mx-2 flex">
                                    <p th:text="${comic.getAvgRating()}" id="avgRating">4.5</p>
                                    <p>/5 stars</p>
                                </div>
                                <button
                                        class="list-user-rating text-sm font-medium text-indigo-600 hover:text-indigo-500"
                                        th:text="${countRating} + ' reviews'">234 reviews
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="flex font-light">
                    <div class="mx-2 flex items-center">
                        <i class="fa-light fa-user-shield"></i>
                    </div>
                    <p class="text-red-600 font-medium" th:text="${comic.getAuthor()}">{comic.author}</p>
                </div>
                <div class="flex font-light">
                    <div class="mx-2 flex items-center">
                        <i class="fa-light fa-tags"></i>
                    </div>
                    <div class="flex">
                        <div th:each="category, this : ${comic.getCategoriesComics()}" class="flex">
                            <a th:href="'/comics/genres/' + ${category.getCategory().getSlug()}  + '-' + ${category.getCategory().getId()}" class="font-medium text-indigo-600 hover:text-indigo-500">
                                <p th:text="${category.getCategory().getTitle()}">Live action</p>
                            </a>
                            <p th:if="${this.index} != ${comic.getCategoriesComics().size() - 1}" class="mx-2">-</p>
                        </div>
                    </div>
                </div>
                <div class="flex font-light">
                    <div class="mx-2 flex items-start">
                        <i class="fa-light fa-memo-pad"></i>
                    </div>
                    <div class="line-clamp-2">
                        <p th:text="${comic.getDescription()}">Cập nhật thứ 4 và chủ nhật hàng tuần] Nữ hài nghịch công
                            lược băng sơn tổng tài. Vườn trường ? Chức trường ? Tư muội ? Tôi đều có thể</p>
                        <p>Xem Thêm</p>
                    </div>
                </div>
                <!-- button -->
                <div class="flex flex-col sm:flex-row font-normal mt-4 justify-center sm:justify-start">
                    <div id="btn-read-now" class="m-2">
                        <!-- button read now -->
                    </div>
                    <div id="btn-read-update" class="m-2">
                        <!-- button read update -->
                    </div>
                    <div class="m-2">
                        <form th:action="@{/comics/likes}" id="wishlist" method="post">
                            <input name="titleSlug" th:value="${comic.getTileSlug()}" hidden/>
                        </form>
                        <div>
                            <button th:if="${isLiked}" type="submit" form="wishlist"
                                    class="p-2 w-full bg-transparent hover:scale-110 duration-300 ease-in-out rounded flex items-center border border-red-500">
                                <div class="mr-1 text-red-600 dark:text-red-300">
                                    <i class="fa-light fa-thumbs-up"></i>
                                </div>
                                <p class="text-red-600 dark:text-red-300">Liked</p>
                            </button>
                            <button th:unless="${isLiked}" type="submit" form="wishlist"
                                    class="p-2 w-full bg-transparent hover:scale-110 duration-300 ease-in-out rounded flex items-center border border-red-500">
                                <div class="mr-1 text-black dark:text-gray-300">
                                    <i class="fa-light fa-thumbs-up"></i>
                                </div>
                                <p class="text-black dark:text-gray-300">Like</p>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- chapters -->
<section>
    <div class="mx-auto mt-6 max-w-4xl px-6 sm:max-w-7xl sm:px-8">
        <div class="flex w-full font-medium items-center border-b py-1">
            <i class="fa-sharp fa-light fa-list-timeline mr-2 text-red-500 fa-xl"></i>
            <p class="text-xl dark:text-white">Danh Sách Chương</p>
        </div>
        <div class="md:px-4 py-2">
            <div id="btn-taps-list"
                 class="grid grid-cols-4 sm:grid-cols-6 md:grid-cols-8 lg:grid-cols-10 gap-4 p-2 rounded bg-gray-50 dark:bg-slate-800">
                <!-- list taps chapter -->
            </div>
            <!-- list chapter -->
            <div id="chapter-taps-list"
                 class="max-h-96 overflow-y-auto px-8 py-4 mt-4 bg-gray-50 dark:bg-slate-800 scrollbar-hidden">
                <!-- list chapter -->
                <button type="button"
                        class="inline-flex justify-center py-4 px-6 w-full rounded border border-red-500 hover:bg-red-50 dark:bg-slate-800 dark:hover:bg-slate-500 dark:border-green-500 dark:text-white"
                >
                    <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-red-500 dark:text-green-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    Đang tải chương...
                </button>
            </div>
        </div>
    </div>
</section>
<!-- comment -->
<section th:replace="~{fragments/comments :: comments}"></section>
<!-- footer -->
<footer th:replace="~{fragments/footer :: footer}"></footer>
<!-- modal rating -->
<main>
    <section id="modal-comic-rating" class="hidden justify-center fixed inset-0 z-30 overflow-y-auto">
        <div id="modal-content-comic-rating"
             class="z-20 transition translate-y-2.5 opacity-0 duration-300 ease-in-out"
        >
            <div class="sm:max-w-lg py-8">
                <div class="bg-white p-1 rounded">
                    <div class="flex justify-between items-center p-4 border-b">
                        <h3 class="text-lg font-semibold">Đánh giá truyện</h3>
                        <button id="btn-close-modal-comic-rating" class="text-gray-500 hover:text-gray-700">
                            <i class="fa-light fa-times"></i>
                        </button>
                    </div>
                    <div class="p-4">
                        <form action="/ratings/comic/add" method="post">
                            <input type="text" name="comicId" id="comicId" th:value="${comic.getId()}" hidden>
                            <input type="text" name="rate" id="rate" value="5" hidden>
                            <textarea
                                    name="content"
                                    id="content"
                                    cols="30"
                                    rows="5"
                                    placeholder="Đánh giá..."
                                    class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:border-indigo-500"
                            ></textarea>
                            <div class="flex justify-center mt-4">
                                <button
                                        type="submit"
                                        class="p-2 w-1/2 bg-indigo-500 text-white rounded hover:bg-indigo-600"
                                >
                                    Đánh giá
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <!-- overlay -->
        <div id="overlay-comic-rating" class="hidden z-10">
            <div id="overlay-body-comic-rating"
                 class="fixed inset-0 w-full h-screen bg-gray-500/50 blur-sm transition duration-300 ease-in-out opacity-0"></div>
        </div>
    </section>
</main>
<!-- modal list user rating -->
<main>
    <section id="modal-list-user-rating" class="hidden justify-center fixed inset-0 z-30 overflow-hidden">
        <div id="modal-content-list-user-rating"
             class="z-20 transition translate-y-2.5 opacity-0 duration-300 ease-in-out"
        >
            <div class="sm:max-w-lg py-8">
                <div class="bg-white p-1 rounded">
                    <div class="flex justify-between items-center p-4 border-b gap-4">
                        <h3 class="text-lg font-semibold">Danh sách đánh giá</h3>
                        <button id="btn-close-modal-list-user-rating" class="text-gray-500 hover:text-gray-700">
                            <i class="fa-light fa-times"></i>
                        </button>
                    </div>
                    <div class="p-4">
                        <div class="flex flex-col gap-2 items-center" id="list-user-rating">
                            <div class="flex items-center gap-4">
                                <img
                                        src="https://st.nettruyenus.com/data/comics/97/nguoi-thua-ke.jpg"
                                        alt="avatar"
                                        class="h-10 w-10 rounded-full object-cover"
                                />
                                <div class="">
                                    <div class="flex gap-2">
                                        <p class="font-medium">Nguyen Van Bao</p>
                                        <p>4/5</p>
                                        <svg class="text-yellow-500 h-5 w-5" viewBox="0 0 20 20"
                                             fill="currentColor" aria-hidden="true">
                                            <path fill-rule="evenodd"
                                                  d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.381c-.833.067-1.171 1.107-.536 1.651l3.62 3.102-1.106 4.637c-.194.813.691 1.456 1.405 1.02L10 15.591l4.069 2.485c.713.436 1.598-.207 1.404-1.02l-1.106-4.637 3.62-3.102c.635-.544.297-1.584-.536-1.65l-4.752-.382-1.831-4.401z"
                                                  clip-rule="evenodd"/>
                                        </svg>
                                    </div>
                                    <small>Content danh gia Content danh gia Content danh gia</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- overlay -->
        <div id="overlay-list-user-rating" class="hidden z-10">
            <div id="overlay-body-list-user-rating"
                 class="fixed inset-0 w-full h-screen bg-gray-500/50 blur-sm transition duration-300 ease-in-out opacity-0"></div>
        </div>
    </section>
</main>

<!-- script modal rating -->
<script th:src="@{/js/comics/details.comics.js}"></script>
</body>
</html>